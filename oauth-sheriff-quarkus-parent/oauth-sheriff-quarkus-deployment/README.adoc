= CUI JWT Quarkus Deployment
:toc: left
:toclevels: 3
:sectnumlevels: 1
:source-highlighter: highlight.js
:toc-title: Table of Contents
:sectnums:


Deployment module for Quarkus integration providing build-time processing and DevUI components for JWT token validation.

== Maven Coordinates

For Maven dependency information, see xref:../README.adoc#maven-coordinates[Maven Coordinates] in the parent module documentation.

== Core Concepts

=== Build-Time Processing
* Automatic reflection registration for JWT validation classes
* Native image configuration for GraalVM compatibility
* Runtime initialization setup for HTTP-based JWKS loaders
* Integration with Quarkus deployment pipeline

=== DevUI Integration
* Development-time debugging interface for JWT validation
* JSON-RPC services for interactive token analysis
* Web components for JWT configuration inspection
* See xref:../doc/development/devui-implementation.adoc[DevUI Implementation Documentation] for comprehensive technical details

=== Extension Architecture
* Follows Quarkus extension patterns with separate deployment and runtime modules
* Provides build items for configuration and reflection setup
* Integrates with Quarkus development mode features

== Detailed Component Documentation

=== OAuthSheriffProcessor
Main deployment processor handling build-time configuration:

* link:src/main/java/de/cuioss/jwt/quarkus/deployment/OAuthSheriffProcessor.java[OAuthSheriffProcessor]
* Registers JWT validation classes for reflection
* Configures runtime initialization for HTTP components
* Sets up DevUI integration in development mode
* Provides health check integration

=== DevUI Components
Development interface components:

* link:src/main/java/de/cuioss/jwt/quarkus/deployment/OAuthSheriffDevUIJsonRPCService.java[OAuthSheriffDevUIJsonRPCService] - JSON-RPC service for DevUI communication
* Web components in `src/main/resources/dev-ui/` for interactive JWT debugging

For detailed component architecture, implementation details, and testing framework, see xref:../doc/development/devui-implementation.adoc[DevUI Implementation Documentation].

== Usage Examples

=== Basic Extension Usage
To use the Quarkus extension, add the deployment module dependency:

[source, xml]
----
<dependency>
    <groupId>de.cuioss.sheriff.oauth</groupId>
    <artifactId>oauth-sheriff-quarkus-deployment</artifactId>
</dependency>
----

This will automatically include the runtime module as a transitive dependency.

=== Development Mode
Access DevUI components during development:

[source, bash]
----
./mvnw quarkus:dev
# Navigate to http://localhost:8080/q/dev/
# Find "CUI JWT" section for JWT validation tools
----

== Configuration

The deployment module automatically configures build-time settings. No additional configuration is required for basic usage.

=== Reflection Configuration
Automatically registers these classes for reflection:

**Classes with Methods and Constructors:**

* `de.cuioss.sheriff.oauth.core.TokenValidator` - Main validation component
* `de.cuioss.sheriff.oauth.quarkus.config.IssuerConfigResolver` - Configuration resolver
* `de.cuioss.sheriff.oauth.core.security.SecurityEventCounter` - Security metrics
* `io.micrometer.core.instrument.MeterRegistry` - Metrics registry

**Configuration Classes (Methods Only):**

* `de.cuioss.sheriff.oauth.core.IssuerConfig` - Issuer configuration
* `de.cuioss.sheriff.oauth.core.ParserConfig` - Parser settings
* `de.cuioss.sheriff.oauth.core.jwks.http.HttpJwksLoaderConfig` - JWKS loader configuration

**Runtime Initialization:**

* `de.cuioss.sheriff.oauth.core.jwks.http.HttpJwksLoader` (runtime initialized for native image compatibility)

=== Native Image Support
Configures GraalVM native image compilation with automatic reflection registration and runtime initialization.

For detailed configuration, reflection classes, and testing information, see xref:../doc/configuration/native-image-configuration.adoc[Native Image Configuration].

== Best Practices

* Use development mode to debug JWT validation issues
* Leverage DevUI components for configuration verification
* Monitor validation status through provided health checks
* Test native image builds with representative JWT configurations

== Technical Details

=== Thread Safety
* All deployment processors are thread-safe
* DevUI services handle concurrent requests appropriately
* Build items are immutable and safe for parallel processing

=== Performance Characteristics
* Minimal runtime overhead - most processing occurs at build time
* DevUI components only active in development mode
* Efficient reflection registration reduces startup time

=== Dependencies
* Requires Quarkus 3.x framework
* Integrates with Quarkus security, health, and DevUI modules
* Compatible with GraalVM native image compilation

== Related Documentation

* xref:../oauth-sheriff-quarkus/README.adoc[Runtime Module Documentation]
* xref:../doc/integration/quarkus-integration.adoc[Quarkus Integration Architecture]
* xref:../doc/development/devui-implementation.adoc[DevUI Implementation Documentation]
* xref:../doc/development/devui-testing.adoc[DevUI Testing Guide]
* xref:../doc/configuration/native-image-configuration.adoc[Native Image Configuration]
* xref:../../../doc/specification/technical-components.adoc[Technical Components Specification]
