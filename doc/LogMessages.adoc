= Log Messages for JWT Token Module
:toc: left
:toclevels: 3
:toc-title: Table of Contents
:sectnums:
:source-highlighter: highlight.js

== Overview

This document provides a reference for all log messages used in the JWT Token Validation library.

=== Document Navigation

* xref:../README.adoc[README] - Project overview and introduction
* xref:../oauth-sheriff-core/README.adoc[Usage Guide] - How to use the library with code examples
* xref:Requirements.adoc[Requirements] - Functional and non-functional requirements
* xref:Specification.adoc[Specification] - Technical specifications
* xref:security/Threat-Model.adoc[Threat Model] - Security analysis and mitigations
* xref:Build.adoc[Building and Development] - Information for contributors

=== Log Message Format

All messages follow the format: JWTValidation-[identifier]: [message]

The log message levels follow these identifier ranges:

* INFO Level: 1-99
* WARN Level: 100-199
* ERROR Level: 200-299

Note: Only log level INFO and above are documented in this file.

=== Using Log Messages for Troubleshooting

The log messages can be used for troubleshooting issues with the JWT Token Validation library. Each log message is associated with a specific component and provides information about what is happening in the system.

For more details about security events related to these log messages, see the SecurityEventCounter implementation in xref:specification/technical-components.adoc#_securityeventcounter[Technical Components].

== INFO Level (001-008)

[cols="1,1,2,2", options="header"]
|===
|ID |Component |Message |Description
|JWTValidation-001 |TOKEN |TokenValidator initialized with %s issuer configurations |Logged when TokenValidator is initialized with issuer configurations
|JWTValidation-002 |JWKS |Keys updated due to data change - load state: %s |Logged when JWKS keys are updated due to data changes from the endpoint
|JWTValidation-003 |JWKS |Successfully loaded JWKS from HTTP endpoint |Logged when JWKS is successfully loaded from HTTP endpoint
|JWTValidation-004 |JWKS |Background JWKS refresh started with interval: %s seconds |Logged when background JWKS refresh is started with specified interval
|JWTValidation-005 |JWKS |Background JWKS refresh updated keys, load state: %s |Logged when background JWKS refresh successfully updates keys
|JWTValidation-006 |TOKEN |Skipping disabled issuer configuration %s |Logged when an issuer configuration is skipped because it's disabled
|JWTValidation-007 |JWKS |Successfully resolved JWKS URI from well-known endpoint: %s |Logged when JWKS URI is successfully resolved via well-known discovery
|JWTValidation-008 |RETRY |Retry operation '%s' completed successfully after %s attempts in %sms |Logged when a retry operation completes successfully with timing information
|JWTValidation-009 |JWKS |JWKS loaded successfully for issuer: %s |Logged when JWKS is successfully loaded for a specific issuer
|JWTValidation-010 |ISSUER |Issuer configuration loaded successfully: %s |Logged when an issuer configuration is successfully loaded
|===

== WARN Level (100-146)

[cols="1,1,2,2", options="header"]
|===
|ID |Component |Message |Description
|JWTValidation-100 |TOKEN |Token exceeds maximum size limit of %s bytes, validation will be rejected |Logged when a token is rejected due to size constraints
|JWTValidation-101 |TOKEN |The given validation was empty, request will be rejected |Logged when an empty or null token is provided
|JWTValidation-102 |TOKEN |No key found with ID: %s |Logged when a key with the specified ID cannot be found in the JWKS
|JWTValidation-103 |TOKEN |Failed to decode JWT Token |Logged when the JWT token cannot be decoded
|JWTValidation-104 |TOKEN |Invalid JWT Token format: expected 3 parts but got %s |Logged when the JWT token format is invalid
|JWTValidation-105 |TOKEN |Decoded part exceeds maximum size limit of %s bytes |Logged when a decoded part of the token exceeds the maximum size limit
|JWTValidation-106 |TOKEN |Unsupported algorithm: %s |Logged when an unsupported algorithm is encountered
|JWTValidation-107 |TOKEN |Token has a 'not before' claim that is more than 60 seconds in the future |Logged when a token has a 'not before' claim that is too far in the future
|JWTValidation-108 |TOKEN |Unknown validation type: %s |Logged when an unknown token type is encountered
|JWTValidation-109 |TOKEN |Token is missing required claim: %s |Logged when a token is missing a required claim
|JWTValidation-110 |TOKEN |Token has expired |Logged when a token has expired
|JWTValidation-111 |TOKEN |Token authorized party '%s' does not match expected client ID '%s' |Logged when the azp claim in the token does not match the expected client ID
|JWTValidation-112 |TOKEN |Missing recommended element: %s |Logged when a recommended element is missing from the token
|JWTValidation-113 |TOKEN |Token audience %s does not match any of the expected audiences %s |Logged when the audience in the token does not match any of the expected audiences
|JWTValidation-114 |TOKEN |No configuration found for issuer: %s |Logged when no configuration is found for the issuer
|JWTValidation-115 |TOKEN |Algorithm %s is explicitly rejected for security reasons |Logged when an algorithm is explicitly rejected for security reasons
|JWTValidation-116 |JWKS |Creating HttpJwksLoaderConfig with invalid JWKS URI. The loader will return empty results. |Logged when an invalid JWKS URI is provided to HttpJwksLoaderConfig
|JWTValidation-117 |JWKS |Load operation failed but using cached content |Logged when JWKS load operation fails but cached content is available and used
|JWTValidation-118 |JWKS |Load operation failed with no cached content available |Logged when JWKS load operation fails and no cached content is available
|JWTValidation-119 |JWKS |JWK is missing required field 'kty' |Logged when a JWK key is missing the required 'kty' parameter
|JWTValidation-120 |JWKS |Unsupported key type: %s |Logged when an unsupported JWK key type is encountered
|JWTValidation-121 |JWKS |Key ID exceeds maximum length: %s |Logged when a JWK key ID exceeds the maximum allowed length
|JWTValidation-122 |JWKS |Invalid or unsupported algorithm: %s |Logged when an invalid or unsupported algorithm is encountered in a JWK
|JWTValidation-123 |TOKEN |Found unhealthy issuer config: %s |Logged when an issuer configuration is found to be unhealthy during health checks
|JWTValidation-124 |JWKS |Background refresh skipped - no HTTP cache available |Logged when background JWKS refresh is skipped due to missing HTTP cache
|JWTValidation-125 |JWKS |Background JWKS refresh failed: %s |Logged when background JWKS refresh operation fails
|JWTValidation-126 |JWKS |Failed to resolve JWKS URI from well-known resolver |Logged when JWKS URI resolution fails from well-known discovery
|JWTValidation-127 |JWKS |JWKS object is null |Logged when JWKS object validation fails due to null object
|JWTValidation-128 |JWKS |JWKS keys array exceeds maximum size: %s |Logged when JWKS keys array exceeds the maximum allowed size
|JWTValidation-129 |JWKS |JWKS keys array is empty |Logged when JWKS keys array is empty
|JWTValidation-130 |JWKS |Failed to parse RSA key with ID %s: %s |Logged when RSA key parsing fails for a specific key ID
|JWTValidation-131 |JWKS |Failed to parse EC key with ID %s: %s |Logged when EC key parsing fails for a specific key ID
|JWTValidation-132 |RETRY |Retry operation '%s' failed after %s attempts in %sms |Logged when a retry operation fails after exhausting all attempts
|JWTValidation-133 |JSON |Failed to parse JWKS JSON: %s |Logged when JSON parsing fails for JWKS content and an empty result is returned as fallback
|JWTValidation-134 |ISSUER |IssuerConfig for issuer '%s' has claimSubOptional=true. This is not conform to RFC 7519 which requires the 'sub' claim for ACCESS_TOKEN and ID_TOKEN types. Use this setting only when necessary and ensure appropriate alternative validation mechanisms. |Logged when an issuer configuration has the subject claim marked as optional, which violates RFC 7519 requirements
|JWTValidation-135 |JWKS |Invalid Base64 URL encoding detected for JWK field: %s |Logged when Base64 URL encoding validation fails for a JWK field
|JWTValidation-136 |JWKS |Background refresh skipped - no HTTP handler available |Logged when background JWKS refresh is skipped because no HTTP handler is available
|JWTValidation-137 |JWKS |Background refresh IO error: %s for issuer: %s |Logged when an IO error occurs during background JWKS refresh for a specific issuer
|JWTValidation-138 |JWKS |Background refresh parse error: %s for issuer: %s |Logged when a JSON parsing error occurs during background JWKS refresh for a specific issuer
|JWTValidation-139 |JWKS |Background refresh key processing error: %s for issuer: %s |Logged when a key processing error occurs during background JWKS refresh for a specific issuer
|JWTValidation-140 |ISSUER |Failed to load issuer configuration for %s, status: %s |Logged when issuer configuration loading fails with a specific status
|JWTValidation-141 |JWKS |Timeout waiting for JWKS to load for issuer: %s |Logged when JWKS loading times out for a specific issuer
|JWTValidation-142 |JWKS |Interrupted while waiting for JWKS to load for issuer: %s |Logged when the thread is interrupted while waiting for JWKS to load
|JWTValidation-143 |JWKS |Configured issuer '%s' does not match discovered issuer '%s' from well-known document |Logged when there is a mismatch between configured and discovered issuer from well-known endpoint
|JWTValidation-144 |JWKS |Using insecure HTTP protocol for JWKS endpoint: %s - HTTPS should be used in production |Logged when an insecure HTTP protocol is used for JWKS endpoint instead of HTTPS
|JWTValidation-145 |JWKS |DSL-JSON returned null for JWKS parsing |Logged when DSL-JSON parser returns null while parsing JWKS content
|JWTValidation-146 |JWKS |Failed to parse JWKS content: %s |Logged when JWKS content parsing fails due to IO error or invalid JSON structure
|===

== ERROR Level (200-211)

[cols="1,1,2,2", options="header"]
|===
|ID |Component |Message |Description
|JWTValidation-200 |TOKEN |Failed to validate validation signature: %s |Logged when a token signature validation fails
|JWTValidation-201 |JWKS |JWKS content size exceeds maximum allowed size (upperLimit=%s, actual=%s) |Logged when the JWKS content size exceeds the maximum allowed size, showing both the configured upper limit and the actual content size
|JWTValidation-202 |JWKS |Failed to parse JWKS JSON: %s |Logged when there is an error parsing the JWKS JSON
|JWTValidation-203 |JWKS |Failed to load JWKS |Logged when a JWKS load operation fails
|JWTValidation-204 |JWKS |Unsupported JwksType for HttpJwksLoader: %s |Logged when an unsupported JWKS type is encountered in HttpJwksLoader
|JWTValidation-205 |WELLKNOWN |Failed to parse JSON from %s: %s |Logged when JSON parsing fails for a well-known discovery document
|JWTValidation-206 |CACHE |Token passed validation but has no expiration time - this indicates a validation bug |Logged when a validated token unexpectedly has no expiration time, indicating a validation pipeline bug
|JWTValidation-207 |CACHE |Unexpected error while caching token |Logged when an unexpected error occurs while storing a validated token in the cache
|JWTValidation-208 |CACHE |Validation function returned null instead of throwing exception |Logged when a validation function unexpectedly returns null instead of throwing an exception on failure
|JWTValidation-209 |CACHE |Error during cache eviction |Logged when an error occurs during background cache eviction operations
|JWTValidation-210 |JWKS |JWKS initialization failed: %s for issuer: %s |Logged when JWKS initialization fails for a specific issuer with error details
|JWTValidation-211 |JWKS |JWKS load execution failed: %s for issuer: %s |Logged when JWKS load execution fails for a specific issuer with error details
|===

== Quarkus Integration Messages

This section documents log messages specific to the Quarkus integration module (oauth-sheriff-quarkus).

=== Quarkus INFO Level (001-099)

==== Configuration Messages (001-010)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-001 |RESOLVING_ISSUER_CONFIGURATIONS |"Resolving issuer configurations from properties" |Indicates the start of issuer configuration resolution from application properties
|CUI_JWT_QUARKUS-002 |RESOLVED_ISSUER_CONFIGURATION |"Resolved issuer configuration: %s" |Shows a single resolved issuer configuration with its details
|CUI_JWT_QUARKUS-003 |RESOLVED_ENABLED_ISSUER_CONFIGURATIONS |"Resolved %s enabled issuer configurations" |Summary count of all enabled issuer configurations found
|CUI_JWT_QUARKUS-004 |RESOLVED_PARSER_CONFIG |"Resolved ParserConfig: maxTokenSize=%s bytes, maxPayloadSize=%s bytes, maxStringLength=%s, maxBufferSize=%s" |Shows the resolved JWT parser configuration limits
|===

==== Validation Messages (011-020)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-011 |INITIALIZING_JWT_VALIDATION_COMPONENTS |"Initializing JWT validation components from configuration" |Indicates the start of JWT validation component initialization
|CUI_JWT_QUARKUS-012 |JWT_VALIDATION_COMPONENTS_INITIALIZED |"JWT validation components initialized successfully with %s issuers" |Confirms successful initialization with issuer count
|CUI_JWT_QUARKUS-013 |RESOLVING_ACCESS_LOG_FILTER_CONFIG |"Resolving access log filter configuration from properties" |Indicates the start of access log filter configuration resolution
|===

==== Metrics Messages (021-030)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-021 |INITIALIZING_JWT_METRICS_COLLECTOR |"Initializing JwtMetricsCollector" |Indicates the start of JWT metrics collector initialization
|CUI_JWT_QUARKUS-022 |JWT_METRICS_COLLECTOR_INITIALIZED |"JwtMetricsCollector initialized with %s event types" |Confirms successful initialization with event type count
|===

==== Cache Messages (041-050)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-041 |RESOLVING_ACCESS_TOKEN_CACHE_CONFIG |"Resolving access token cache configuration from properties" |Indicates the start of access token cache configuration resolution
|CUI_JWT_QUARKUS-042 |ACCESS_TOKEN_CACHE_DISABLED |"Access token cache disabled (maxSize=0)" |Indicates that the access token cache is disabled
|CUI_JWT_QUARKUS-043 |ACCESS_TOKEN_CACHE_CONFIGURED |"Access token cache configured: maxSize=%s, evictionIntervalSeconds=%s" |Shows the configured access token cache settings
|===

==== Metrics Management Messages (051-060)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-051 |CLEARING_JWT_METRICS |"Clearing all JWT metrics" |Indicates that all JWT metrics are being cleared
|CUI_JWT_QUARKUS-052 |JWT_METRICS_CLEARED |"JWT metrics cleared successfully" |Confirms successful clearing of JWT metrics
|===

==== JWKS Startup Messages (061-070)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-060 |JWKS_STARTUP_SERVICE_INITIALIZED |"JWKS startup service activated for background key loading" |Indicates that the JWKS startup service has been activated
|CUI_JWT_QUARKUS-061 |STARTING_ASYNCHRONOUS_JWKS_INITIALIZATION |"Starting asynchronous JWKS initialization for %s issuer(s)" |Indicates the start of background JWKS loading with issuer count
|CUI_JWT_QUARKUS-062 |NO_ISSUER_CONFIGURATIONS_FOUND |"No issuer configurations found - skipping JWKS initialization" |Indicates that JWKS initialization is skipped due to no configured issuers
|CUI_JWT_QUARKUS-063 |BACKGROUND_JWKS_INITIALIZATION_COMPLETED |"Background JWKS initialization completed successfully" |Confirms successful completion of background JWKS initialization
|CUI_JWT_QUARKUS-064 |BACKGROUND_JWKS_LOADING_COMPLETED_FOR_ISSUER |"Background JWKS loading completed for issuer: %s with status: %s" |Shows the completion status for a specific issuer's JWKS loading
|===

==== Access Log Filter Messages (065-070)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-065 |CUSTOM_ACCESS_LOG_FILTER_INITIALIZED |"CustomAccessLogFilter initialized: %s" |Shows the initialized access log filter configuration
|CUI_JWT_QUARKUS-066 |ACCESS_LOG_ENTRY |"%s" |Individual access log entry in the configured format
|===

=== Quarkus WARN Level (100-199)

==== Health Check Warnings (100-110)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-100 |ERROR_CHECKING_JWKS_LOADER |"Error checking JWKS loader for issuer %s: %s" |Indicates an error occurred while checking JWKS loader status in health check
|===

==== Bearer Token Warnings (121-130)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-128 |BEARER_TOKEN_REQUIREMENTS_NOT_MET_DETAILED |"Bearer token does not meet requirements. Missing scopes: %s, Missing roles: %s, Missing groups: %s" |Details about which requirements are missing from a bearer token
|===

==== JWKS Startup Warnings (131-140)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-131 |BACKGROUND_JWKS_LOADING_FAILED_FOR_ISSUER |"Background JWKS loading failed for issuer %s: %s" |Indicates that background JWKS loading failed for a specific issuer
|CUI_JWT_QUARKUS-133 |NO_MICROMETER_COUNTER_FOUND |"No Micrometer counter found for event type %s, delta %s lost" |Indicates that a metrics counter was not found and a delta value was lost
|CUI_JWT_QUARKUS-134 |JWKS_LOADING_RETRY_WARNING |"JWKS loading failed for issuer %s: %s - will retry via background refresh" |Indicates that JWKS loading failed but will be retried
|CUI_JWT_QUARKUS-135 |BACKGROUND_JWKS_ISSUES_WARNING |"Background JWKS initialization encountered issues: %s - on-demand loading will handle this" |Indicates issues during background JWKS initialization with fallback to on-demand loading
|===

=== Quarkus ERROR Level (200-299)

==== Infrastructure Errors (200-210)

[cols="1,2,3,4", options="header"]
|===
|ID |LogRecord |Template |Description

|CUI_JWT_QUARKUS-201 |VERTX_REQUEST_CONTEXT_UNAVAILABLE |"Vertx HttpServerRequest context is unavailable - no active request context found" |Indicates that the Vertx HTTP server request context could not be resolved
|===