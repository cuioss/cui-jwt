@startuml
!include plantuml.skin

title JWT Token Format: Header.Payload.Signature

left to right direction

package "Header" #E3F2FD {
  node "alg: RS256\ntyp: JWT\nkid: key-123" as h1
}

node "  **.**  " as dot1 #FFFFFF

package "Payload" #FFF9C4 {
  node "iss: auth.example.com\nsub: user@example.com\naud: api.example.com\nexp: 1735862400\nnbf: 1735776000\niat: 1735776000\njti: abc-123-xyz\n... custom claims" as p1
}

node "  **.**  " as dot2 #FFFFFF

package "Signature" #FFEBEE {
  node "HMAC-SHA256(\n  base64UrlEncode(header) + \".\" +\n  base64UrlEncode(payload),\n  secret\n)" as s1
}

Header -[hidden]-> dot1
dot1 -[hidden]-> Payload
Payload -[hidden]-> dot2
dot2 -[hidden]-> Signature

note bottom of Header
  Base64Url Encoded
end note

note bottom of Payload
  Base64Url Encoded
end note

note bottom of Signature
  Base64Url Encoded
end note

@enduml
